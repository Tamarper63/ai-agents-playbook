{% assign purl = page.url | default: '' %}

<nav class="site-nav" aria-label="Primary">
  <div class="site-nav__inner">
    {% for item in site.data.nav.items %}
      {% assign is_cta = false %}
      {% if item.cta == true or item.is_cta == true %}
        {% assign is_cta = true %}
      {% endif %}

      {% unless is_cta %}
        {% assign is_active = false %}
        {% assign item_url = item.url | default: '' %}
        {% assign ac = item.active_contains | default: '' %}
        {% assign is_external = false %}

        {% if item_url contains '://' %}
          {% assign is_external = true %}
        {% endif %}

        {% if item_url != '' and purl == item_url %}
          {% assign is_active = true %}
        {% elsif ac != '' and purl contains ac %}
          {% assign is_active = true %}
        {% endif %}

        {% if is_active %}
          {% if is_external %}
            <a class="site-nav__link site-nav__link--active" href="{{ item_url }}" aria-current="page" rel="noopener" target="_blank">{{ item.label }}</a>
          {% else %}
            <a class="site-nav__link site-nav__link--active" href="{{ item_url | relative_url }}" aria-current="page">{{ item.label }}</a>
          {% endif %}
        {% else %}
          {% if is_external %}
            <a class="site-nav__link" href="{{ item_url }}" rel="noopener" target="_blank">{{ item.label }}</a>
          {% else %}
            <a class="site-nav__link" href="{{ item_url | relative_url }}">{{ item.label }}</a>
          {% endif %}
        {% endif %}
      {% endunless %}
    {% endfor %}
  </div>
</nav>