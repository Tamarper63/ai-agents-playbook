<!DOCTYPE html>
<html lang="{{ site.lang | default: 'en-US' }}">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    {% seo %}

    {% assign cache_bust = site.github.build_revision %}
    {% unless cache_bust %}
      {% assign cache_bust = site.time | date: '%s' %}
    {% endunless %}

    <link rel="stylesheet" href="{{ '/assets/css/style.css?v=' | append: cache_bust | relative_url }}">

    {% include head-custom.html %}
  </head>

  <body>
    <a id="skip-to-content" href="#content">Skip to the content.</a>

    {% assign purl = page.url | default: '' %}

    {% assign header_class = 'page-header' %}
    {% unless purl == '/' %}
      {% assign header_class = header_class | append: ' page-header--compact' %}
    {% endunless %}

    <header class="{{ header_class }}" role="banner">
      {% if purl == '/' %}
        <h1 class="project-name">
          <a href="{{ '/' | relative_url }}">{{ site.title }}</a>
        </h1>
        <h2 class="project-tagline">{{ site.description }}</h2>
      {% else %}
        <div class="project-name">
          <a href="{{ '/' | relative_url }}">{{ site.title }}</a>
        </div>
      {% endif %}
    </header>

    <!-- Primary navigation (global) -->
    <nav class="site-nav" aria-label="Primary">
      <div class="site-nav__inner">
        {% if purl == '/' %}
          <a href="{{ '/' | relative_url }}" aria-current="page">Home</a>
        {% else %}
          <a href="{{ '/' | relative_url }}">Home</a>
        {% endif %}

        {% if purl contains '/policies/' %}
          <a href="{{ '/policies/' | relative_url }}" aria-current="page">Policies</a>
        {% else %}
          <a href="{{ '/policies/' | relative_url }}">Policies</a>
        {% endif %}

        {% if purl contains '/prompts/' %}
          <a href="{{ '/prompts/' | relative_url }}" aria-current="page">Prompts</a>
        {% else %}
          <a href="{{ '/prompts/' | relative_url }}">Prompts</a>
        {% endif %}

        {% if purl contains '/how-to/' %}
          <a href="{{ '/how-to/' | relative_url }}" aria-current="page">How-to</a>
        {% else %}
          <a href="{{ '/how-to/' | relative_url }}">How-to</a>
        {% endif %}

        {% if purl contains '/articles/' %}
          <a href="{{ '/articles/' | relative_url }}" aria-current="page">Articles</a>
        {% else %}
          <a href="{{ '/articles/' | relative_url }}">Articles</a>
        {% endif %}

        {% if purl contains '/reference/' %}
          <a href="{{ '/reference/' | relative_url }}" aria-current="page">Reference</a>
        {% else %}
          <a href="{{ '/reference/' | relative_url }}">Reference</a>
        {% endif %}

        {% if purl contains '/newsletter/' %}
          <a href="{{ '/newsletter/' | relative_url }}" aria-current="page">Newsletter</a>
        {% else %}
          <a href="{{ '/newsletter/' | relative_url }}">Newsletter</a>
        {% endif %}
      </div>
    </nav>

    <main id="content" class="main-content" role="main">
      {% if page.title and page.show_title != false %}
        <h1 class="page-title">{{ page.title }}</h1>
      {% endif %}

      {{ content }}
    </main>

    <footer class="site-footer" role="contentinfo">
      {% assign social_name = site.social.name | default: '' %}

      <ul class="footer-links" aria-label="Social links">
        {% if site.social.links %}
          {% for link in site.social.links %}
            {% if link contains 'linkedin.com' %}
              <li><a href="{{ link }}">LinkedIn</a></li>
            {% elsif link contains 'github.com' %}
              <li><a href="{{ link }}">GitHub</a></li>
            {% endif %}
          {% endfor %}
        {% endif %}

        {% if social_name != '' %}
          <li><span>© {{ site.time | date: '%Y' }} {{ social_name }}</span></li>
        {% endif %}
      </ul>

      {%- comment -%}
      Newsletter:
      - Render in footer on all pages except the dedicated /newsletter/ page (prevents duplication).
      - The /newsletter/ page includes the same component inside the page content.
      {%- endcomment -%}
      {% unless purl contains '/newsletter/' %}
        {% include newsletter.html mode="footer" %}
      {% endunless %}

      <div class="build-info">
        {% assign rev = site.github.build_revision | default: '' %}
        <span>Build</span>
        {% if rev != '' %}
          <code>{{ rev | slice: 0, 7 }}</code>
        {% else %}
          <code>N/A</code>
        {% endif %}
        <span>·</span>
        <span>{{ site.time | date: "%Y-%m-%d %H:%M %Z" }}</span>

        {% if site.github.repository_url %}
          <span>·</span>
          <a href="{{ site.github.repository_url }}">Source</a>
        {% endif %}
      </div>
    </footer>
  </body>
</html>
